from pwn import *

def main(input):

    t = process(['python2','service.py'])
    t.recvline()
    t.sendline(input)
    a = t.recvall()
    encoded = a.decode()
    return encoded[64:96]

if __name__ == '__main__':
    flag = ''
    while True:
        print("===============================================================================")
        payload = "0"*(47-len(flag))
        hex = main(payload)
        print(hex)
        for i in range(33, 125):
            if main(payload + flag + chr(i)) == hex:
                flag += chr(i)
                print("Flag: ", flag)
                break